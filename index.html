<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <title>Document</title>
</head>

<body>

    <main class="creator-main-container">
        <nav class="creator-main-nav">
            <div class="creator-nav-button" @click="currentTab = 'construct'">Конструктор</div>
            <div class="creator-nav-button" @click="currentTab = 'result'">Результат</div>
        </nav>
        <div class="creator-tabs-container">
            <div class="creator-tab tab-construct" :class="{ 'tab-hidden': currentTab === 'result' }">
                <form action="">
                    <div v-if="1 === 2">
                    <label for="title">Название ДПП</label><input type="text" name="title" v-model="title">
                    <label for="authors">Автор/Авторский коллектив</label><input type="text" name="authors" v-model="authors">
                    <div class="row">
                        <div class="col">
                            <label for="coordPosition">Должность согласующего</label><input type="text" name="coordPosition"
                                v-model="coordPosition">
                        </div>
                        <div class="gap"></div>
                        <div class="col">
                            <label for="coordName">ФИО согласующего</label><input type="text" name="coordName" v-model="coordName">
                        </div>
                    </div>
                    <label for="relevance">Актуальность программы</label>
                    <textarea id="relevance" v-model="relevance" rows="6"></textarea>
                    <label for="target">Цель</label>
                    <textarea id="target" v-model="target" rows="2"></textarea>
                    <label for="studentsCategory">Категория обучающихся (слушателей)</label>
                    <select name="studentsCategory">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                    </select>
                    <label for="learningForm">Форма обучения</label>
                    <select name="learningForm">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                    </select>
                    <div class="row">
                        <div class="col">
                            <label for="">Режим аудиторных занятий – <input class="hours" type="number" name=""> часов
                                в день</label>
                        </div>
                        <div class="gap"></div>
                        <div class="col">
                            <label for="">Срок освоения программы – <input class="hours" type="number" name="">
                                часа(ов)</label>
                        </div>
                    </div>
                    </div>

                    <section class="modules">
                        <h3>Структура программы</h3>
                        <br>
                        <ul v-if="modules && modules.length">
                            <li v-for="module in modules" :key="module.index" @click="moduleOpen(module)" :data-module="module.id">
                                {{ module.title }}
                                <ul v-if="moduleThemes(module.id)">
                                    <li v-for="theme in moduleThemes(module.id)" :key="theme.index" @click="themeOpen(theme)" :data-theme="theme.id">
                                        {{ theme.title }}
                                        <ul v-if="themeActivities(theme.id)">
                                            <li v-for="activity in themeActivities(theme.id)" :key="activity.index" @click="activityOpen(activity)" :data-activity="activity.id">
                                                {{ activity.title }}
                                                <ul v-if="activityCompetencies(activity.id)">
                                                    <li v-for="competence in activityCompetencies(activity.id)" :key="competence.index" @click="competenceOpen(competence)" :data-competence="competence.id">
                                                        {{ competence.title }}
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </section>

                    <section class="content-add module-add" :class="{ 'module-add-darken': themeAddVisible }" v-if="moduleAddVisible">
                        <header>
                            <div class="left">
                                <span class="close" @click="moduleAddVisible = false">&times;</span>
                            </div>
                            <div class="title">
                                <h3>Добавление модуля</h3>
                            </div>
                            <div class="right"></div>
                        </header>
                        <main>
                            <form action="">
                                <label>Наименование модуля</label><input type="text" v-model="curModule.title">
                                <section class="content-add theme-add" :class="{ 'theme-add-darken': activityAddVisible }" v-if="themeAddVisible">
                                    <header>
                                        <div class="left">
                                            <span class="close" @click="themeAddVisible = false">&times;</span>
                                        </div>
                                        <div class="title">
                                            <h3>Добавление темы</h3>
                                        </div>
                                        <div class="right"></div>
                                    </header>
                                    <main>
                                        <label>Наименование темы</label><input type="text" v-model="curTheme.title">
                                        <section class="content-add activity-add" :class="{ 'activity-add-darken': competenceAddVisible }" v-if="activityAddVisible">
                                            <header>
                                                <div class="left">
                                                    <span class="close" @click="activityAddVisible = false">&times;</span>
                                                </div>
                                                <div class="title">
                                                    <h3>Добавление вида деятельности</h3>
                                                </div>
                                                <div class="right"></div>
                                            </header>
                                            <main>
                                                <label>Вид деятельности/ОТФ/ТФ</label><input type="text" v-model="curActivity.title">
                                                <section class="content-add competence-add" v-if="competenceAddVisible">
                                                    <header>
                                                        <div class="left">
                                                            <span class="close" @click="competenceAddVisible = false">&times;</span>
                                                        </div>
                                                        <div class="title">
                                                            <h3>Добавление компетенции</h3>
                                                        </div>
                                                        <div class="right"></div>
                                                    </header>
                                                    <main>
                                                        <label>Профессиональная компетенция</label><input type="text" v-model="curCompetence.title">
                                                        <label>Практический опыт</label><input type="text" v-model="curCompetence.experience">
                                                        <label>Умение</label><input type="text" v-model="curCompetence.skill">
                                                        <label>Знание</label><input type="text" v-model="curCompetence.knowledge">
                                                    </main>
                                                    <footer>
                                                        <span class="button" @click="competenceSave(close)">Сохранить</span>
                                                        <span class="button" @click="competenceRemove()">Удалить профессиональную компетенцию</span>
                                                    </footer>
                                                </section>
                                            </main>
                                            <footer>
                                                <span class="button" :class="{ 'button-disabled': competenceAddVisible }" @click="activitySave(close)">Сохранить</span>
                                                <span class="button" :class="{ 'button-disabled': competenceAddVisible }" @click="competenceAdd(curActivity.id); activitySave()">Добавить профессиональную компетенцию</span>
                                                <span class="button" :class="{ 'button-disabled': competenceAddVisible }" @click="activityRemove()">Удалить вид деятельности</span>
                                            </footer>
                                        </section>
                                        <div class="row">
                                            <div class="col">
                                                <label>Общая трудоемкость</label><input type="number" v-model="curTheme.labor">
                                            </div>
                                            <div class="gap"></div>
                                            <div class="col">
                                                <label>Трудоемкость для ППС</label><input type="number" v-model="curTheme.labor_pps">
                                            </div>
                                        </div>
                                        <br>
                                        <h3><i>Аудиторные учебные занятия:</i></h3>
                                        <br>
                                        <div class="row">
                                            <div class="col">
                                                <label>Лекции</label><input type="number" v-model="curTheme.lections">
                                            </div>
                                            <div class="gap"></div>
                                            <div class="col">
                                                <label>Интерактивные занятия</label><input type="number" v-model="curTheme.interactives">
                                            </div>
                                        </div>
                                        <br>
                                        <h3><i>Внеаудиторные учебные занятия:</i></h3>
                                        <br>
                                        <div class="row">
                                            <div class="col">
                                                <label>Теоретическая часть</label><input type="number" v-model="curTheme.theory">
                                            </div>
                                            <div class="gap"></div>
                                            <div class="col">
                                                <label>Практическая часть</label><input type="number" v-model="curTheme.practice">
                                            </div>
                                        </div>
                                        <label for="forms">Формы контроля</label>
                                        <textarea id="forms" rows="2" v-model="curTheme.controls"></textarea>
                                        <label for="content">Содержание темы</label>
                                        <textarea id="content" rows="5" v-model="curTheme.contents"></textarea>
                                    </main>
                                    <footer>
                                        <span class="button" :class="{ 'button-disabled': activityAddVisible }" @click="themeSave(close)">Сохранить</span>
                                        <span class="button" :class="{ 'button-disabled': activityAddVisible }" @click="activityAdd(curTheme.id); themeSave()">Добавить вид деятельности</span>
                                        <span class="button" :class="{ 'button-disabled': activityAddVisible }" @click="themeRemove()">Удалить тему</span>
                                    </footer>
                                </section>
                            </form>
                        </main>
                        <footer>
                            <span class="button" :class="{ 'button-disabled': themeAddVisible }" @click="moduleSave(close)">Сохранить</span>
                            <span class="button" :class="{ 'button-disabled': themeAddVisible }" @click="themeAdd(curModule.id); moduleSave()">Добавить тему</span>
                            <span class="button" :class="{ 'button-disabled': themeAddVisible }" @click="moduleRemove()">Удалить модуль</span>
                        </footer>
                    </section>
                </form>
                <footer class="creator-main-actions">
                    <span class="button" :class="{ 'button-disabled': moduleAddVisible }" @click="moduleAdd()" v-if="currentTab === 'construct'">Добавить модуль</span>
                    <span class="button" @click="exportToDoc()" v-if="currentTab === 'result'">Сохранить в формате <code>.doc</code></span>
                </footer>
            </div>
            <div class="creator-tab tab-result" :class="{ 'tab-hidden': currentTab === 'construct' }">
                <section class="result">
                    <div id="page0" class="font12pt">
                        <p class="center" style="margin-bottom:24pt;"><b>МИНИСТЕРСТВО ОБРАЗОВАНИЯ МОСКОВСКОЙ ОБЛАСТИ</b></p>
                        <p class="center"><b>Государственное бюджетное  образовательное учреждение</b></p>
                        <p class="center"><b>высшего образования Московской области</b></p>
                        <p class="center"><b>«Академия социального управления»</b></p>
                        <p class="center" style="margin-top:36pt;"><b>Кафедра информационно-коммуникационных технологий</b></p>
                        <div class="center" style="margin-top:12pt;">
                        <table class="left" style="margin-top:12pt;">
                            <thead><th style="padding-right:36pt;">«СОГЛАСОВАНО»</th><th>«УТВЕРЖДАЮ»</th></thead>
                            <tbody>
                                <tr>
                                    <td style="padding-right:36pt;">на заседании Учёного совета<br>от «_____»___________ 20__г.<br>Протокол № _______</td>
                                    <td>Ректор  ____________А.И. Салов<br><br>«____»_______________20__г.</td>
                                </tr>
                            </tbody>
                        </table>
                        </div>
                        <p class="center" style="margin-top:96pt; font-size:14pt;"><b>Дополнительная профессиональная программа</b></p>
                        <p class="center" style="margin-top:12pt; font-size:14pt;"><b>(повышение квалификации)</b></p>
                        <p class="center" style="margin-top:12pt; font-size:14pt;"><b><i>Название ДПП</i></b></p>
                        <p class="center" style="margin-top:36pt;"><b><i>Автор / Авторский коллектив:</i></b></p>
                        <p class="center"><i>ФИО автора</i></p>
                        <div style="margin-top:96pt;">
                        <table style="width:100%;">
                            <tbody>
                                <tr>
                                    <td class=""><i>Должность согласующего</i></td>
                                    <td class="right">______________</td>
                                    <td class=""><i>ФИО согласующего</i></td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="center" style="margin-top:96pt;"><i>2018 г.</i><br clear="all" class="pageBreak"></p>
                        </div>
                    </div>

                    <table border="1" cellpadding="0" cellspacing="0" style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <th>Виды деятельности/ОТФ/ТФ</th>
                            <th>Профессиональные компетенции (имеющиеся или осваиваемые)/ТД</th>
                            <th>Практический опыт</th>
                            <th>Умения</th>
                            <th>Знания</th>
                        </tr>
                        <!-- <template v-for="a in activities" :key="a.index">
                            <tr>
                                <td :rowspan="a.data.competencies.length || 1">{{ a.data.title }}</td>
                                <td v-if="a.data.competencies[0]">{{ a.data.competencies[0].data.title }}</td>
                                <td v-else>—</td>
                                <td v-if="a.data.competencies[0]">{{ a.data.competencies[0].data.experience }}</td>
                                <td v-else>—</td>
                                <td v-if="a.data.competencies[0]">{{ a.data.competencies[0].data.skill }}</td>
                                <td v-else>—</td>
                                <td v-if="a.data.competencies[0]">{{ a.data.competencies[0].data.knowledge }}</td>
                                <td v-else>—</td>
                            </tr>
                            <template v-for="c in noOneArray(a.data.competencies)" :key="c.index">
                                <tr>
                                    <td>{{ c.data.title || '—' }}</td>
                                    <td>{{ c.data.experience || '—' }}</td>
                                    <td>{{ c.data.skill || '—' }}</td>
                                    <td>{{ c.data.knowledge || '—' }}</td>
                                </tr>
                            </template>
                            
                        </template> -->
                    </table>

                </section>
                <footer class="creator-main-actions">
                    <span class="button" :class="{ 'button-disabled': moduleAddVisible }" @click="moduleAdd()" v-if="currentTab === 'construct'">Добавить модуль</span>
                    <span class="button" @click="exportToDoc()" v-if="currentTab === 'result'">Сохранить в формате
                        <code>.doc</code></span>
                </footer>
            </div>
        </div>
    </main>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.min.js"></script>
    <script src="style.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let creator = new Vue({
                el: '.creator-main-container',
                data() {
                    return {
                        currentTab: 'construct', // construct / result
                        moduleAddVisible: false,
                        themeAddVisible: false,
                        activityAddVisible: false,
                        competenceAddVisible: false,
                        title: '',
                        authors: '',
                        coordPosition: '',
                        coordName: '',
                        relevance: '1.1.1. Нормативную правовую основу разработки программы составляют: (приводятся ссылки на нормативно - правовые документы с указанием соответствующих разделов, пунктов, подпунктов, конкретного содержания данных разделов)./r/n1.1.2.Дополнительная профессиональная программа повышения квалификации «Название программы» разработана на основе профессиональных стандартов (квалификационных требований)(Приводится наименование профессионального стандарта, который использовался при разработке программы (http://profstandart.rosmintrud.ru/reestr-professionalnyh-standartov).При отсутствии профессионального стандарта приводится наименование соответствующего раздела Единого квалификационного справочника должностей руководителей, специалистов и служащих (ЕКС) - http://profstandart.rosmintrud.ru/eksd), либо ФГОС ВО по соответствующему направлению подготовки http://www.edu.ru/abitur/act.82/index.php#Par768',
                        target: '1.2. Цель - совершенствование и (или) получение новой(ых) компетенции(й), необходимой(ых) для профессиональной деятельности, и(или) повышение профессионального уровня в рамках имеющейся квалификации и в соответствии с профессиональными стандартами.',
                        curModule: {
                            id: null,
                            type: 'module',
                            title: '',
                        },
                        curTheme: {
                            id: null,
                            parent_id: null,
                            type: 'theme',
                            title: '',
                            labor: 0,
                            labor_pps: 0,
                            lections: 0,
                            interactives: 0,
                            theory: 0,
                            practice: 0,
                            controls: '',
                            contents: '',
                        },
                        curActivity: {
                            id: null,
                            parent_id: null,
                            type: 'activity',
                            title: '',
                        },
                        curCompetence: {
                            id: null,
                            parent_id: null,
                            type: 'competence',
                            title: '',
                            experience: '',
                            skill: '',
                            knowledge: ''
                        },
                        items: [],
                    }
                },
                computed: {
                    modules() {
                        return this.items.filter(i => i.type === 'module');
                    },
                    themes() {
                        return this.items.filter(i => i.type === 'theme');
                    },
                    activities() {
                        return this.items.filter(i => i.type === 'activity');
                    },
                    competencies() {
                        return this.items.filter(i => i.type === 'competence');
                    },
                },
                mounted() {
                    this.setStyle();
                    this.items = JSON.parse(localStorage.getItem('items')) || [];
                    let headerData = localStorage.getItem('headerData') || '';
                    if (headerData.length) {
                        let parsedData = JSON.parse(headerData);
                        this.title = parsedData.title;
                        this.authors = parsedData.authors;
                        this.coordPosition = parsedData.coordPosition;
                        this.coordName = parsedData.coordName;
                        this.relevance = parsedData.relevance;
                        this.target = parsedData.target;
                    }
                    console.log(this.modules);
                    console.log(this.themes);
                    console.log(this.activities);
                    console.log(this.competencies);
                    window.onbeforeunload = () => {
                    // this.storageSave();
                    };
                },
                methods: {
                    setStyle() {
                        let a = [];
                        let style = document.createElement("style");
                        style.textContent = STYLE;
                        document.getElementsByTagName("head")[0].appendChild(style);
                    },
                    ///////
                    moduleThemes(id) {
                        return this.themes.filter(t => t.parent_id === id);
                    },
                    themeActivities(id) {
                        return this.activities.filter(a => a.parent_id === id);
                    },
                    activityCompetencies(id) {
                        return this.competencies.filter(c => c.parent_id === id);
                    },
                    ///////
                    storageSave() {
                        localStorage.setItem('items', JSON.stringify(this.items) || []);
                        let tmp = {
                            title: this.title,
                            authors: this.authors,
                            coordPosition: this.coordPosition,
                            coordName: this.coordName,
                            relevance: this.relevance,
                            target: this.target
                        };
                        localStorage.setItem('headerData', JSON.stringify(tmp));
                    },
                    // ******* Modules *******
                    moduleAdd() {
                        this.curModule.title = '';
                        this.curModule.id = Date.now();
                        this.moduleAddVisible = true;
                    },
                    moduleSave(close) {
                        if (!this.curModule.title) {
                            close = false;
                            alert('Необходимо указать название модуля');
                            return;
                        }
                        let found = this.items.some(i => {
                            return i.id === this.curModule.id;
                        });
                        if (!found) {
                            let tmp = JSON.parse(JSON.stringify(this.curModule));
                            this.items.push(tmp);
                            this.storageSave();
                        } else {
                            this.moduleUpdate();
                        }
                        if (close) this.moduleClose();
                    },
                    moduleOpen(module) {
                        this.curModule = {...module};
                        this.moduleAddVisible = true;
                    },
                    moduleUpdate() {
                        let items = [...this.items];
                        let index = items.map(i => {
                            return i.id
                        }).indexOf(this.curModule.id);
                        if (index > -1) {
                            items[index] = {...this.curModule};
                            this.items = items;
                            this.storageSave();
                            console.log(this.items);
                        }
                    },
                    moduleRemove() {
                        let ask = confirm('Вы уверены?');
                        if (ask) {
                            let index = this.items.map(i => {
                                return i.index
                            }).indexOf(this.curModule.index);
                            if (index > -1) {
                                this.items.splice(index, 1);
                                this.storageSave();
                                this.moduleAddVisible = false;
                            }
                        }
                    },
                    moduleClose() {
                        this.moduleAddVisible = false;
                        this.themeAddVisible = false;
                        this.activityAddVisible = false;
                        this.competenceAddVisible = false;
                    },
                    // ******* Themes *******
                    themeAdd(moduleId) {
                        if (!this.curModule.title) return;
                        this.curTheme.title = '';
                        this.curTheme.labor = 0;
                        this.curTheme.labor_pps = 0;
                        this.curTheme.lections = 0;
                        this.curTheme.interactives = 0;
                        this.curTheme.theory = 0;
                        this.curTheme.practice = 0;
                        this.curTheme.controls = '';
                        this.curTheme.contents = '';
                        this.curTheme.id = Date.now();
                        this.curTheme.parent_id = moduleId;
                        this.themeAddVisible = true;
                    },
                    themeSave(close) {
                        if (!this.curTheme.title) {
                            close = false;
                            alert('Необходимо указать название темы');
                            return;
                        }
                        let found = this.items.some(i => {
                            return i.id === this.curTheme.id;
                        });
                        if (!found) {
                            let tmp = JSON.parse(JSON.stringify(this.curTheme));
                            this.items.push(tmp);
                            this.storageSave();
                        } else {
                            this.themeUpdate();
                        }
                        if (close) this.moduleClose();
                    },
                    themeOpen(theme) {
                        this.curTheme = {...theme};
                        this.themeAddVisible = true;
                    },
                    themeUpdate() {
                        let items = [...this.items];
                        let index = items.map(i => {
                            return i.id
                        }).indexOf(this.curTheme.id);
                        if (index > -1) {
                            items[index] = { ...this.curTheme };
                            this.items = items;
                            this.storageSave();
                        }
                    },
                    themeRemove() {
                        let ask = confirm('Вы уверены?');
                        if (ask) {
                            let index = this.items.map(i => {
                                return i.index
                            }).indexOf(this.curTheme.index);
                            if (index > -1) {
                                this.items.splice(index, 1);
                                this.storageSave();
                                this.themeAddVisible = false;
                            }
                        }
                    },
                    // ******* Activities *******
                    activityAdd(themeId) {
                        if (!this.curTheme.title) return;
                        this.curActivity.title = '';
                        this.curActivity.id = Date.now();
                        this.curActivity.parent_id = themeId;
                        this.activityAddVisible = true;
                    },
                    activitySave(close) {
                        if (!this.curActivity.title) {
                            close = false;
                            alert('Необходимо указать название вида деятельности');
                            return;
                        }
                        let found = this.items.some(i => {
                            return i.id === this.curActivity.id;
                        });
                        if (!found) {
                            let tmp = JSON.parse(JSON.stringify(this.curActivity));
                            this.items.push(tmp);
                            this.storageSave();
                        } else {
                            this.activityUpdate();
                        }
                        if (close) this.moduleClose();
                    },
                    activityOpen(activity) {
                        this.curActivity = {...activity};
                        this.activityAddVisible = true;
                    },
                    activityUpdate() {
                        let items = [...this.items];
                        let index = items.map(i => {
                            return i.id
                        }).indexOf(this.curActivity.id);
                        if (index > -1) {
                            items[index] = { ...this.curActivity };
                            this.items = items;
                            this.storageSave();
                        }
                    },
                    activityRemove() {
                        let ask = confirm('Вы уверены?');
                        if (ask) {
                            let index = this.items.map(i => {
                                return i.index
                            }).indexOf(this.curActivity.index);
                            if (index > -1) {
                                this.items.splice(index, 1);
                                this.storageSave();
                                this.activityAddVisible = false;
                            }
                        }
                    },
                    // ******* Competencies *******
                    competenceAdd(activityId) {
                        if (!this.curActivity.title) return;
                        this.curCompetence.title = '';
                        this.curCompetence.experience = '';
                        this.curCompetence.skill = '';
                        this.curCompetence.knowledge = '';
                        this.curCompetence.id = Date.now();
                        this.curCompetence.parent_id = activityId;
                        this.competenceAddVisible = true;
                    },
                    competenceSave(close) {
                        if (!this.curCompetence.title) {
                            close = false;
                            alert('Необходимо указать название профессиональной компетенции');
                            return;
                        }
                        let found = this.items.some(i => {
                            return i.id === this.curCompetence.id;
                        });
                        if (!found) {
                            let tmp = JSON.parse(JSON.stringify(this.curCompetence));
                            this.items.push(tmp);
                            this.storageSave();
                        } else {
                            this.moduleUpdate();
                        }
                        if (close) this.moduleClose();
                    },
                    competenceOpen(competence) {
                        this.curCompetence = {...competence};
                        this.competenceAddVisible = true;
                    },
                    competenceUpdate() {
                        let items = [...this.items];
                        let index = items.map(i => {
                            return i.id
                        }).indexOf(this.curCompetence.id);
                        if (index > -1) {
                            items[index] = { ...this.curCompetence };
                            this.items = items;
                            this.storageSave();
                        }
                    },
                    competenceRemove() {
                        let ask = confirm('Вы уверены?');
                        if (ask) {
                            let index = this.items.map(i => {
                                return i.index
                            }).indexOf(this.curCompetence.index);
                            if (index > -1) {
                                this.items.splice(index, 1);
                                this.storageSave();
                                this.competenceAddVisible = false;
                            }
                        }
                    },
                    // ******* Export to .doc *******
                    exportToDoc() {
                        let preHtml = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><style>"+STYLE+"</style><title>Export HTML To Doc</title></head><body>";
                        let postHtml = "</body></html>";
                        let html = preHtml + document.querySelector('.result').innerHTML + postHtml;
                        let blob = new Blob(['\ufeff', html], {
                            type: 'application/msword'
                        });
                        let url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);
                        filename = 'document.doc';
                        let downloadLink = document.createElement('a');
                        document.body.appendChild(downloadLink);
                        if (navigator.msSaveOrOpenBlob) {
                            navigator.msSaveOrOpenBlob(blob, filename);
                        } else {
                            downloadLink.href = url;
                            downloadLink.download = filename;
                            downloadLink.click();
                        }
                        document.body.removeChild(downloadLink);
                    },
                    // result page
                    // array without first elem
                    noOneArray(arr) {
                        return [...arr].slice(1);
                    }
                }
            });
        });
    </script>



    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', 'Open Sans', 'Trebuchet MS', 'Verdana', 'Tahoma', sans-serif;
            font-size: 15px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        html,
        body {
            height: 100%;
            width: 100%;
        }

        body {
            display: flex;
            justify-content: center;
        }

        ul {
            margin: 0;
            padding: 0;
            list-style-type: none;
        }

        li {
            padding-left: 15px;
        }

        .button {
            background-color: #da251d;
            border: none;
            color: white;
            cursor: pointer;
            padding: 5px 15px;
            margin-right: 25px;
            transition: background-color 0.1s;
            user-select: none;
            -moz-user-select: none;
        }

        .button:hover {
            background-color: #3088b8;
        }

        .button-disabled {
            pointer-events: none;
            background-color: #777777;
        }

        .creator-main-container {
            display: flex;
            flex-direction: column;
            min-height: 860px;
            width: 1274px;
            min-width: 1274px;
        }

        .creator-main-nav,
        .creator-main-actions {
            display: flex;
            width: 100%;
        }

        .creator-main-nav {
            height: 40px;
        }

        .creator-main-actions {
            height: 50px;
            background: #ffffff;
            padding: 10px 0;
        }

        .creator-nav-button {
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            cursor: pointer;
            transition: background-color 0.18s;
        }

        .creator-nav-button:hover {
            background: #dfdfdf;
        }

        .creator-tabs-container {
            display: flex;
            flex: 1;
        }

        .creator-tab {
            min-height: 100%;
            flex: 1;
            background: rgba(255, 255, 255, 0.8);
            padding: 5px;
        }

        .creator-tab .result {
            padding: 30px;
        }

        .creator-tab .result * {
            font-family: 'Times New Roman', serif;
        }

        .creator-tab.tab-hidden {
            display: none;
        }

        form label {
            display: block;
            width: 100%;
        }

        form input,
        form select,
        form textarea {
            background-color: #ffffff;
            border: 1px solid #c9ccd4;
            margin: 7px 0;
            border-radius: 2px;
            padding: 3px 6px;
            box-shadow: inset 0 1px 3px #dddddd;
        }

        form input,
        form textarea {
            width: 100%;
        }

        form textarea {
            resize: vertical;
        }

        form input.hours {
            width: 80px;
        }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            margin: 0;
        }

        input[type='number'] {
            -moz-appearance: textfield;
        }

        .row {
            width: 100%;
            display: flex;
        }

        .row .col {
            flex: 1;
        }

        .row .gap {
            width: 15px;
        }

        .content-add.module-add.module-add-darken {
            background: #d6d6d6;
            pointer-events: none;
        }

        .content-add.theme-add.theme-add-darken {
            background: #e4e4e4;
            pointer-events: none;
        }

        .content-add.activity-add.activity-add-darken {
            pointer-events: none;
            background: #f3f3f3;
        }

        .content-add.module-add {
            margin: 15px 0 5px 0;
        }

        .content-add.module-add,
        .content-add.theme-add,
        .content-add.activity-add,
        .content-add.competence-add {
            background: #fdfdfd;
            padding: 0 15px 5px 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px #888888;
            pointer-events: all;
        }

        .content-add header,
        .content-add footer {
            display: flex;
            height: 40px;
        }

        .content-add header {
            border-top: 1px solid #aaa;
        }

        .content-add footer {
            padding: 5px 15px;
            border-bottom: 1px solid #aaa;
        }

        .content-add.module-add header,
        .content-add.module-add footer {
            border: none;
        }

        .content-add header .left,
        .content-add header .right {
            flex: 1;
        }

        .content-add header .left {
            justify-content: flex-start;
        }

        .content-add header .right {
            justify-content: flex-end;
        }

        .content-add header .title {
            flex: 8;
            width: 90%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .content-add header .close {
            color: #da251d;
            font-size: 28px;
            font-weight: bold;
        }

        .content-add header .close:hover,
        .content-add header .close:focus {
            color: #3088b8;
            text-decoration: none;
            cursor: pointer;
        }

        .content-add main {
            height: calc(100% - 80px);
            padding: 15px 0;
        }

        .modules {
            border-top: 1px solid #aaa;
            padding-top: 10px;
        }

        .module,
        .theme {
            cursor: pointer;
            color: rgb(49, 49, 230);
        }

        .module:hover,
        .theme:hover {
            color: rgb(22, 22, 223);
        }

        .result table th,
        .result table td {
            padding: 3px;
        }
    </style>
</body>

</html>